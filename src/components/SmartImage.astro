---
import { Picture } from 'astro:assets';
import { loadImage } from '../utils/get-image';

interface Props {
  src: string,
  alt: string,
  title?: string,
  widths?: Array<number>,
  sizes?: string,
  width?: number,
  height?: number,
  pictureAttributes?: {
    class: string
  },
  class?: string,
  loading?: 'eager' | 'lazy' | null | undefined,
  'data-blok-c'?: any,
  'data-blok-uuid'?: any,
}

const {
  src,
  width,
  widths,
  height,
  sizes,
  alt,
  title,
  pictureAttributes
  ,
  loading,
} = Astro.props;

if (!src) {
  return;
}

const image = await loadImage(src, width, height);
---
{image &&
<Picture
  src={src}
  inferSize
  formats={['avif', 'webp']}
  quality="high"
  widths={widths || [1593, 1080, 800, 640, 420, 250]}
  sizes={sizes || '(max-width: 540px) 250px, (max-width: 650px) 420px, (max-width: 768px) 640px, (max-width: 1024px) 800px, (max-width: 1280px) 1080px, 1593px'}
  alt={alt}
  title={title || alt}
  pictureAttributes={pictureAttributes}
  class={Astro.props?.class}
  loading={loading || 'lazy'}
/>}
